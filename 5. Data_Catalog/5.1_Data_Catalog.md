# Harvesting the Metadata from Oracle Object Storage using Data Catalog
This is the process of scanning and extracting schema-level **metadata** (like file names, formats, columns, data types) from data stored in **Object Storage**. This metadata is then cataloged and organized within the **Data Catalog**, making it easier to discover, govern, and manage data assets.

For this I had to create a **VCN**, review my **policies**, and learn how to integrate **Data Lake** (Object Storage) with **Oracle Data catalog**.

## Virtual Cloud Network Creation in OCI. 
From my OCI account I clicked in *Menu* (☰) > *Networking* > *Virtual Cloud Networks* > *Options* > *Start VCN Wizard* > *Create VCN with Internet Connectivity* > *Start VCN Wizard*.

![vcn](/Assets/VCN.png)

This popped up a *Configuration* window, where I only set up the *VCN Name* as **DataLake_VCN**. Next, inside the *Review and Create* window I checked and left all fields as predetermined.

I waited for the VCN creation and clicked on *View Virtual Cloud Network*.

## Reviewing Existent Policies in OCI
I went to *Menu* (☰) > *Identity* > *Policies*. As I only had the root compartment the policy has **ADMIN** privileges, so I can absolutely use the **Data Catalog**.

## Data Catalog Creation
I clicked on *Menu* (☰) > *Analytics and AI* > *Data Catalog* > inside the compartment for this project > *Create Data Catalog*. I provided the name **Datalake_Datacatalog** and created it.

My **Data Catalog** home page looks like this:

![DC](/Assets/Data_Catalog.png)

## Data Asset Creation
Inside my newly created **Datalake_Datacatalog** I clicked on *Data Assets* > *Create Data Asset*. I set the following: 

- **Name**: Oracle Object Storage Data Asset
- **Description**: Creating a Data Asset for Object Storage
- **Type**: Oracle Object Storage 
- **URL (format)**: https://swiftobjectstorage.< region-identifier >.< realm_domain >
- **Namespace**: you can find this code inside your OIC profile by clicking on *Tenancy* > and there, under *Object Storage* Settings should appear > *Namespace*.

And clicked *Create*.

You will, however, get the following message:

![DAP](/Assets/DAP.png)

This means that, even though my user has **ADMIN** privileges, and therefore I'm able to access *Object Storage*, I needed to explicitly state the permission for the *Data Catalog* instance **Datalake_Datacatalog** to also access *OS*.  

To do this, I followed these steps:

### Dynamic Group Creation
I navigated to *Menu* (☰) > *Identity & Security* > *Domains*. There, I selected the domain I was using for this project, in my case, the **Default** domain. 

Once inside the domain, I clicked on *Dynamic groups* from the ribbon options. Then, *Create dynamic group*. I provided the following information:

- **Name**: datacatalog_group
- **Description**: Dynamic group for Data Catalog access to Object Storage
- **Matching rules**: Match all rules defined below
 Rule 1: ALL {resource.id = 'YOUR DATA CATALOG OCID'}

And clicked *Create*.

![DGC](/Assets/DG.png)

### Dynamic Group Policy Creation
After that, I navigated to *Menu* (☰) > *Identity & Security* > *Policies* > *Create Policy*. And provided the following information:

- **Name**: dynamic_group_policy
- **Description**: Allow dynamic-group datacatalog_group to read object-family in tenancy
- **Compartment**: root (in my case, as I’m working inside it)
- **Policy Builder** (manual editor): Allow dynamic-group YOUR DYNAMIC GROUP NAME to read object-family in compartment NAME OF THE COMPARTMENT YOU ARE USING

And clicked *Create*.

We are now ready to make a connection between *Data Catalog* and *Object Storage*.

## Adding a Connection for the Data Asset
Once I had completed those steps I went inside the newly created *Oracle Object Storage: Oracle Object Storage Data Asset*, clicked on *Add connection* and enter the following details:
- **Name**: Oracle Object Storage Connection
- **Description**: Adding a connection
- **Type**: Resource Principal
- **OCI** Region: mx-queretaro-1
- **Compartment OCID**: in my case the root compartment. But should be the one you're using for Object Storage.

I selected *Make this the default connection for the data asset* and clicked *Test Connection*. Once validated I clicked on *Add*.

## Harvesting the Data Asset
Inside my data asset, I clicked *Harvest*. It showed me the following:
- **Select a Connection**: I made sure it was to *OS* and I clicked *Next*.
- **Select Data Entities**: I selected the bucket where the *Object Storage** were stored, meaning the **DataLake_ObjectStorage**. I then added all the data entities I wanted to harvest:
    - *customers.csv*
    - *promotions.csv*
    - *supplementary_demographics.csv*
    - *times.csv*
And clicked *Next*.
- **Create Job**: I provided the following details:
    * **Name**: Harvest Object Storage
    * **Description**: optional
    * **Incremental Harvest**: I checked the box.
    * **Include Unrecognized Files**: I checked the box.
    * **Time of Execution**: selected *Run job now*

Then, I clicked *Create Job*.

![harvest](/Assets/Harv.png)

My *Data Asset* was created successfully.

## Review Entities
Inside the *Data Catalog* I navigated to *Home Page* > *Entities*. A list of the harvested entities appeared, indicating that I had successfully integrated the *OS* with the *Data Catalog*.

![dat_ent](/Assets/Dat_Ent.png)